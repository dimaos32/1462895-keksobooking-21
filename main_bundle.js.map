{"version":3,"sources":["webpack://keksobooking/./js/util.js","webpack://keksobooking/./js/backend.js","webpack://keksobooking/./js/form.js","webpack://keksobooking/./js/pin.js","webpack://keksobooking/./js/card.js","webpack://keksobooking/./js/filter.js","webpack://keksobooking/./js/main.js"],"names":["qEndingsMap","room","guest","typesMap","palace","flat","house","bungalow","getRandomIntNumber","min","max","Math","floor","random","window","util","Key","ENTER","ESCAPE","getRandomArrayElements","arr","n","copySource","slice","randomArray","i","length","element","push","swap","getQEndings","q","word","getHousingType","type","addId","array","map","item","Object","assign","id","checkExtensionAccordance","file","some","ending","name","toLowerCase","endsWith","debounce","cb","interval","lastTimeout","args","clearTimeout","setTimeout","API_URL","makeRequest","method","url","onSuccess","onError","data","xhr","XMLHttpRequest","responseType","timeout","open","send","addEventListener","status","response","statusText","backend","load","FILE_TYPES","DEFAULT_AVATAR_PIC","minPricesMap","capacityOptions","1","2","3","100","mapFilters","document","querySelector","adForm","adFormReset","adFormAvatarInput","adFormAvatarPreview","adFormTitle","adFormAddress","adFormPrice","adFormType","adFormTime","adFormTimein","adFormTimeout","adFormRoomNumber","adFormCapacity","adFormPhotoInput","adFormPhoto","toggleElementsState","form","isOn","fieldsets","querySelectorAll","selects","forEach","fieldset","disabled","select","completeAddressInput","coords","pin","getMainMapPinCoords","value","x","y","changeCapacityOptions","innerHTML","syncPrice","minPrice","placeholder","onSendSuccess","page","successMessage","content","cloneNode","append","remove","evt","key","src","reset","main","deactivatePage","onSendError","errorMessage","target","files","reader","FileReader","result","readAsDataURL","onAvatarLoad","valueLength","setCustomValidity","reportValidity","price","photoPreview","createElement","classList","add","onPhotoLoad","preventDefault","FormData","isPageActivated","enableForm","disableForm","offersZone","mainMapPin","pinTemplate","round","parseInt","style","left","MAIN_MAP_PIN_WIDTH","top","MAIN_MAP_PIN_HEIGHT","controlsMainMapPinCoords","renderOfferPin","offer","offerPreset","location","PIN_WIDTH","dataset","author","avatar","alt","title","deleteOfferPins","contains","button","startCoords","clientX","clientY","onMouseMove","moveEvt","shift","offsetLeft","offsetTop","onMouseUp","upEvt","removeEventListener","activatePage","mainMapPinReset","updateOfferPins","card","closePopup","fragment","createDocumentFragment","renderOfferPins","cardTemplate","openedCard","popupClose","renderOfferCard","address","rooms","guests","checkin","checkout","features","description","photos","popupAvatar","popupTitle","popupAddress","popupPrice","popupType","popupCapacity","popupTime","popupFeatures","popupDescription","popupPhotos","textContent","feature","addOfferFeatures","templatePopupPhoto","photo","popupPhoto","addOfferPhotos","Array","from","children","child","tagName","removeEmptyNodes","removeChild","onPopupClose","onPopupEscPress","onPopupEnterPress","openOffer","closest","targetPin","activePin","offersWithId","find","openPopup","FILTER_ALL","filterForm","housingType","housingPrice","housingRooms","housingGuests","housingFeatures","checkHousingPrice","checkHousingRooms","checkHousingGuests","checkHousingFeatures","checked","includes","filterOffers","filteredOffers","filter","onLoadSuccess","onLoadError","message","node","body","insertAdjacentElement"],"mappings":"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","file":"main_bundle.js","sourcesContent":["'use strict';\n\nconst DEBOUNCE_INTERVAL = 500;\n\nconst Key = {\n  ENTER: `Enter`,\n  ESCAPE: `Escape`,\n};\n\nconst qEndingsMap = {\n  room: [`комната`, `комнаты`, `комнат`],\n  guest: [`гостя`, `гостей`, `гостей`],\n};\n\nconst typesMap = {\n  palace: `Дворец`,\n  flat: `Квартира`,\n  house: `Дом`,\n  bungalow: `Бунгало`,\n};\n\nconst getRandomIntNumber = (min = 0, max = 100) => {\n  return min + Math.floor(Math.random() * (max - min + 1));\n};\n\nconst getRandomArrayElements = (arr, n = 1) => {\n  let copySource = arr.slice();\n  let randomArray = [];\n\n  for (let i = 0; i < copySource.length && i < n; i++) {\n    const element = getRandomIntNumber(i, copySource.length - 1);\n    randomArray.push(copySource[element]);\n    const swap = copySource[element];\n    copySource[element] = copySource[i];\n    copySource[i] = swap;\n  }\n\n  return randomArray;\n};\n\nconst getQEndings = (q = 1, word) => {\n  if (q % 100 < 11 || q % 100 > 14) {\n    if (q % 10 === 1) {\n      return `${q} ${qEndingsMap[word][0]}`;\n    } else if (q % 10 > 1 && q % 10 < 5) {\n      return `${q} ${qEndingsMap[word][1]}`;\n    }\n  }\n\n  return `${q} ${qEndingsMap[word][2]}`;\n};\n\nconst getHousingType = (type) => {\n  return typesMap[type];\n};\n\nconst addId = (array) => {\n  return array.map((item, i) => {\n    return Object.assign({}, item, {id: `${i}`});\n  });\n};\n\nconst checkExtensionAccordance = (file, arr) => {\n  return arr.some((ending) => {\n    return file.name.toLowerCase().endsWith(ending);\n  });\n};\n\nconst debounce = (cb, interval = DEBOUNCE_INTERVAL) => {\n  let lastTimeout = null;\n\n  return function (...args) {\n\n    if (lastTimeout) {\n      window.clearTimeout(lastTimeout);\n    }\n\n    lastTimeout = window.setTimeout(() => {\n      cb(...args);\n    }, interval);\n  };\n};\n\nwindow.util = {\n  Key,\n  getRandomIntNumber,\n  getRandomArrayElements,\n  getQEndings,\n  getHousingType,\n  addId,\n  checkExtensionAccordance,\n  debounce,\n};\n","'use strict';\n\nconst MILISECONDS_IN_SECOND = 1000;\n\nconst API_URL = `https://21.javascript.pages.academy/keksobooking`;\n\nconst StatusCode = {\n  OK: 200\n};\n\nconst TIMEOUT = 10000;\n\nconst makeRequest = (method, url, onSuccess, onError, data) => {\n  const xhr = new XMLHttpRequest();\n  xhr.responseType = `json`;\n  xhr.timeout = TIMEOUT;\n\n  xhr.open(method, url);\n  if (method === `POST`) {\n    xhr.send(data);\n  } else {\n    xhr.send();\n  }\n\n  xhr.addEventListener(`load`, () => {\n    if (xhr.status === StatusCode.OK) {\n      onSuccess(xhr.response);\n    } else {\n      onError(`Статус ответа: ${xhr.status} ${xhr.statusText}`);\n    }\n  });\n\n  xhr.addEventListener(`error`, function () {\n    onError(`Произошла ошибка соединения`);\n  });\n  xhr.addEventListener(`timeout`, function () {\n    onError(`Запрос не успел выполниться за ${xhr.timeout / MILISECONDS_IN_SECOND} с`);\n  });\n};\n\nconst load = (onSuccess, onError) => {\n  makeRequest(`GET`, `${API_URL}/data`, onSuccess, onError);\n};\n\nconst send = (data, onSuccess, onError) => {\n  makeRequest(`POST`, API_URL, onSuccess, onError, data);\n};\n\nwindow.backend = {\n  load,\n  send,\n};\n","'use strict';\n\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\n\nconst MAX_PRICE = 1000000;\n\nconst FILE_TYPES = [`gif`, `jpg`, `jpeg`, `png`];\n\nconst DEFAULT_AVATAR_PIC = `img/muffin-grey.svg`;\n\nconst minPricesMap = {\n  palace: 10000,\n  flat: 1000,\n  house: 5000,\n  bungalow: 0,\n};\n\nconst capacityOptions = {\n  1: `<option value=\"1\" selected>для 1 гостя</option>`,\n  2: `<option value=\"2\">для 2 гостей</option>\n      <option value=\"1\" selected>для 1 гостя</option>`,\n  3: `<option value=\"3\">для 3 гостей</option>\n      <option value=\"2\">для 2 гостей</option>\n      <option value=\"1\" selected>для 1 гостя</option>`,\n  100: `<option value=\"0\" selected>не для гостей</option>`,\n};\n\nconst mapFilters = document.querySelector(`.map__filters`);\nconst adForm = document.querySelector(`.ad-form`);\nconst adFormReset = document.querySelector(`.ad-form__reset`);\nconst adFormAvatarInput = adForm.querySelector(`.ad-form-header__input`);\nconst adFormAvatarPreview = adForm.querySelector(`.ad-form-header__preview img`);\nconst adFormTitle = adForm.querySelector(`#title`);\nconst adFormAddress = adForm.querySelector(`#address`);\nconst adFormPrice = adForm.querySelector(`#price`);\nconst adFormType = adForm.querySelector(`#type`);\nconst adFormTime = adForm.querySelector(`.ad-form__element--time`);\nconst adFormTimein = adForm.querySelector(`#timein`);\nconst adFormTimeout = adForm.querySelector(`#timeout`);\nconst adFormRoomNumber = adForm.querySelector(`#room_number`);\nconst adFormCapacity = adForm.querySelector(`#capacity`);\nconst adFormPhotoInput = adForm.querySelector(`#images`);\nconst adFormPhoto = adForm.querySelector(`.ad-form__photo`);\n\nlet isPageActivated = false;\n\nconst toggleElementsState = (form, isOn) => {\n  const fieldsets = form.querySelectorAll(`fieldset`);\n  const selects = form.querySelectorAll(`select`);\n\n  fieldsets.forEach((fieldset) => {\n    fieldset.disabled = !isOn;\n  });\n\n  selects.forEach((select) => {\n    select.disabled = !isOn;\n  });\n};\n\nconst completeAddressInput = () => {\n  const coords = window.pin.getMainMapPinCoords();\n\n  adFormAddress.value = `${coords.x}, ${coords.y}`;\n};\n\nconst onAvatarLoad = (evt) => {\n  const file = evt.target.files[0];\n\n  if (window.util.checkExtensionAccordance(file, FILE_TYPES)) {\n    const reader = new FileReader();\n\n    reader.addEventListener(`load`, () => {\n      adFormAvatarPreview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n};\n\nconst onPhotoLoad = (evt) => {\n  const file = evt.target.files[0];\n\n  if (window.util.checkExtensionAccordance(file, FILE_TYPES)) {\n    const reader = new FileReader();\n\n    reader.addEventListener(`load`, () => {\n      const photoPreview = document.createElement(`img`);\n\n      adFormPhoto.innerHTML = ``;\n      photoPreview.src = reader.result;\n      photoPreview.classList.add(`ad-form__photo-preview`);\n      adFormPhoto.append(photoPreview);\n    });\n\n    reader.readAsDataURL(file);\n  }\n};\n\nconst changeCapacityOptions = () => {\n  adFormCapacity.innerHTML = capacityOptions[adFormRoomNumber.value];\n};\n\nconst syncPrice = () => {\n  const minPrice = minPricesMap[adFormType.value];\n  adFormPrice.placeholder = minPrice;\n  adFormPrice.min = minPrice;\n};\n\nconst enableForm = () => {\n  window.form.isPageActivated = true;\n\n  toggleElementsState(adForm, true);\n  toggleElementsState(mapFilters, true);\n  completeAddressInput();\n\n  adForm.classList.remove(`ad-form--disabled`);\n};\n\nconst disableForm = () => {\n  window.form.isPageActivated = false;\n\n  toggleElementsState(adForm, false);\n  toggleElementsState(mapFilters, false);\n  completeAddressInput();\n\n  adForm.classList.add(`ad-form--disabled`);\n\n  changeCapacityOptions();\n  syncPrice();\n};\n\nconst onSendSuccess = () => {\n  const page = document.querySelector(`main`);\n  const successMessage = document.querySelector(`#success`)\n    .content\n    .querySelector(`.success`)\n    .cloneNode(true);\n\n  const onClick = () => {\n    successMessage.remove();\n  };\n\n  const onEscPress = (evt) => {\n    if (evt.key === window.util.Key.ESCAPE) {\n      successMessage.remove();\n    }\n  };\n\n  page.append(successMessage);\n\n  successMessage.addEventListener(`click`, onClick);\n  document.addEventListener(`keydown`, onEscPress);\n\n  adFormAvatarPreview.src = DEFAULT_AVATAR_PIC;\n  adFormPhoto.innerHTML = ``;\n  adForm.reset();\n  window.main.deactivatePage();\n};\n\nconst onSendError = () => {\n  const page = document.querySelector(`main`);\n  const errorMessage = document.querySelector(`#error`)\n  .content\n  .querySelector(`.error`)\n  .cloneNode(true);\n\n  const onClick = () => {\n    errorMessage.remove();\n  };\n\n  const onEscPress = (evt) => {\n    if (evt.key === window.util.Key.ESCAPE) {\n      errorMessage.remove();\n    }\n  };\n\n  page.append(errorMessage);\n\n  errorMessage.addEventListener(`click`, onClick);\n  document.addEventListener(`keydown`, onEscPress);\n};\n\nadFormAvatarInput.addEventListener(`change`, (evt) => {\n  onAvatarLoad(evt);\n});\n\nadFormTitle.addEventListener(`input`, () => {\n  const valueLength = adFormTitle.value.length;\n\n  if (valueLength < MIN_TITLE_LENGTH) {\n    adFormTitle.setCustomValidity(`Еще ${MIN_TITLE_LENGTH - valueLength} символов`);\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    adFormTitle.setCustomValidity(`Удалите лишние ${valueLength - MAX_TITLE_LENGTH} символов`);\n  } else {\n    adFormTitle.setCustomValidity(``);\n  }\n\n  adFormTitle.reportValidity();\n});\n\nadFormPrice.addEventListener(`input`, () => {\n  const price = adFormPrice.value;\n  const minPrice = minPricesMap[adFormType.value];\n\n  if (price < minPrice) {\n    adFormPrice.setCustomValidity(`Минимальная цена за ночь ${minPrice} руб. Вам стоит увеличить цену.`);\n  } else if (price > MAX_PRICE) {\n    adFormPrice.setCustomValidity(`Максимальная цена за ночь ${MAX_PRICE} руб. Вам стоит уменьшить цену.`);\n  } else {\n    adFormPrice.setCustomValidity(``);\n  }\n\n  adFormPrice.reportValidity();\n});\n\nadFormType.addEventListener(`change`, () => {\n  syncPrice();\n});\n\nadFormTime.addEventListener(`change`, (evt) => {\n  adFormTimeout.value = evt.target.value;\n  adFormTimein.value = evt.target.value;\n});\n\nadFormRoomNumber.addEventListener(`change`, () => {\n  changeCapacityOptions();\n});\n\nadFormPhotoInput.addEventListener(`change`, (evt) => {\n  onPhotoLoad(evt);\n});\n\nadForm.addEventListener(`submit`, (evt) => {\n  evt.preventDefault();\n  window.backend.send(new FormData(adForm), onSendSuccess, onSendError);\n});\n\nadFormReset.addEventListener(`click`, (evt) => {\n  evt.preventDefault();\n  window.main.deactivatePage();\n  adFormAvatarPreview.src = DEFAULT_AVATAR_PIC;\n  adFormPhoto.innerHTML = ``;\n\n});\n\nwindow.form = {\n  isPageActivated,\n  completeAddressInput,\n  enableForm,\n  disableForm,\n};\n","'use strict';\n\nconst PIN_WIDTH = 50;\nconst PIN_HEIGHT = 70;\n\nconst MAIN_MAP_PIN_WIDTH = 62;\nconst MAIN_MAP_PIN_HEIGHT = 62;\nconst MAIN_MAP_PIN_NEEDLE_HEIGHT = 22;\n\nconst LOCATION_X_MIN = 0;\nconst LOCATION_X_MAX = 1199;\nconst LOCATION_Y_MIN = 130;\nconst LOCATION_Y_MAX = 630;\n\nconst offersZone = document.querySelector(`.map__pins`);\nconst mainMapPin = offersZone.querySelector(`.map__pin--main`);\nconst pinTemplate = document.querySelector(`#pin`)\n  .content\n  .querySelector(`button`);\n\nconst mainMapPinDefaultPos = `left: 570px; top: 375px;`;\n\nconst mainMapPinReset = () => {\n  mainMapPin.style = mainMapPinDefaultPos;\n};\n\nconst getMainMapPinCoords = () => {\n  const x = Math.round(parseInt(mainMapPin.style.left, 10) + MAIN_MAP_PIN_WIDTH / 2);\n  const y = window.form.isPageActivated\n    ? Math.round(parseInt(mainMapPin.style.top, 10) + MAIN_MAP_PIN_HEIGHT + MAIN_MAP_PIN_NEEDLE_HEIGHT)\n    : Math.round(parseInt(mainMapPin.style.top, 10) + MAIN_MAP_PIN_HEIGHT / 2);\n\n  return {\n    x,\n    y,\n  };\n};\n\nconst controlsMainMapPinCoords = () => {\n  const coords = getMainMapPinCoords();\n\n  const mainPinLeftMin = LOCATION_X_MIN - MAIN_MAP_PIN_WIDTH / 2;\n  const mainPinLeftMax = LOCATION_X_MAX - MAIN_MAP_PIN_WIDTH / 2;\n  const mainPinTopMin = LOCATION_Y_MIN - MAIN_MAP_PIN_HEIGHT - MAIN_MAP_PIN_NEEDLE_HEIGHT;\n  const mainPinTopMax = LOCATION_Y_MAX - MAIN_MAP_PIN_HEIGHT - MAIN_MAP_PIN_NEEDLE_HEIGHT;\n\n  if (parseInt(coords.x, 10) < LOCATION_X_MIN) {\n    mainMapPin.style.left = `${mainPinLeftMin}px`;\n  }\n\n  if (parseInt(coords.x, 10) > LOCATION_X_MAX) {\n    mainMapPin.style.left = `${mainPinLeftMax}px`;\n  }\n\n  if (parseInt(coords.y, 10) < LOCATION_Y_MIN) {\n    mainMapPin.style.top = `${mainPinTopMin}px`;\n  }\n\n  if (parseInt(coords.y, 10) > LOCATION_Y_MAX) {\n    mainMapPin.style.top = `${mainPinTopMax}px`;\n  }\n};\n\nconst renderOfferPin = (offer) => {\n  const offerPreset = pinTemplate.cloneNode(true);\n\n  offerPreset.style = `left: ${offer.location.x - PIN_WIDTH / 2}px; top: ${offer.location.y - PIN_HEIGHT}px`;\n  offerPreset.dataset.id = `${offer.id}`;\n  offerPreset.querySelector(`img`).src = `${offer.author.avatar}`;\n  offerPreset.querySelector(`img`).alt = `${offer.offer.title}`;\n\n  return offerPreset;\n};\n\nconst renderOfferPins = (data) => {\n  const fragment = document.createDocumentFragment();\n\n  for (let i = 0; i < data.length; i++) {\n    fragment.append(renderOfferPin(data[i]));\n  }\n\n  offersZone.append(fragment);\n};\n\nconst deleteOfferPins = () => {\n  const pins = offersZone.querySelectorAll(`.map__pin`);\n\n  pins.forEach((pin) => {\n    if (!pin.classList.contains(`map__pin--main`)) {\n      pin.remove();\n    }\n  });\n};\n\nconst updateOfferPins = (data) => {\n  deleteOfferPins();\n  window.card.closePopup();\n  renderOfferPins(data);\n};\n\nmainMapPin.addEventListener(`mousedown`, (evt) => {\n  if (evt.button === 0) {\n    evt.preventDefault();\n\n    const startCoords = {\n      x: evt.clientX,\n      y: evt.clientY,\n    };\n\n    const onMouseMove = (moveEvt) => {\n      moveEvt.preventDefault();\n\n      const shift = {\n        x: moveEvt.clientX - startCoords.x,\n        y: moveEvt.clientY - startCoords.y,\n      };\n\n      startCoords.x = moveEvt.clientX;\n      startCoords.y = moveEvt.clientY;\n\n      mainMapPin.style.left = `${mainMapPin.offsetLeft + shift.x}px`;\n      mainMapPin.style.top = `${mainMapPin.offsetTop + shift.y}px`;\n\n      controlsMainMapPinCoords();\n      window.form.completeAddressInput();\n    };\n\n    const onMouseUp = (upEvt) => {\n      upEvt.preventDefault();\n\n      window.form.completeAddressInput();\n\n      document.removeEventListener(`mousemove`, onMouseMove);\n      document.removeEventListener(`mouseup`, onMouseUp);\n    };\n\n    document.addEventListener(`mousemove`, onMouseMove);\n    document.addEventListener(`mouseup`, onMouseUp);\n\n    if (!window.form.isPageActivated) {\n      window.main.activatePage();\n    }\n  }\n});\n\nmainMapPin.addEventListener(`keydown`, (evt) => {\n  if (evt.key === window.util.Key.ENTER && !window.form.isPageActivated) {\n    window.main.activatePage();\n  }\n});\n\nwindow.pin = {\n  mainMapPinReset,\n  getMainMapPinCoords,\n  controlsMainMapPinCoords,\n  deleteOfferPins,\n  updateOfferPins\n};\n","'use strict';\n\nconst map = document.querySelector(`.map`);\nconst cardTemplate = document.querySelector(`#card`)\n  .content\n  .querySelector(`.popup`);\n\nlet openedCard;\nlet popupClose;\n\nconst addOfferFeatures = (item, features) => {\n  item.innerHTML = ``;\n\n  for (let i = 0; i < features.length; i++) {\n    const feature = document.createElement(`li`);\n    feature.classList.add(`popup__feature`, `popup__feature--${features[i]}`);\n    item.append(feature);\n  }\n};\n\nconst addOfferPhotos = (item, photos) => {\n  const templatePopupPhoto = item.querySelector(`.popup__photo`);\n\n  item.innerHTML = ``;\n\n  photos.forEach((photo) => {\n    const popupPhoto = templatePopupPhoto.cloneNode(true);\n    popupPhoto.src = photo;\n    item.append(popupPhoto);\n  });\n};\n\nconst removeEmptyNodes = (item) => {\n  Array.from(item.children).forEach((child) => {\n    if (child.tagName !== `IMG` && !child.innerHTML) {\n      child.remove();\n    }\n  });\n};\n\nconst renderOfferCard = (item) => {\n  const {\n    author: {\n      avatar\n    },\n    id,\n    offer: {\n      title,\n      address,\n      price,\n      type,\n      rooms,\n      guests,\n      checkin,\n      checkout,\n      features,\n      description,\n      photos,\n    },\n  } = item;\n\n  const offerPreset = cardTemplate.cloneNode(true);\n  const popupAvatar = offerPreset.querySelector(`.popup__avatar`);\n  const popupTitle = offerPreset.querySelector(`.popup__title`);\n  const popupAddress = offerPreset.querySelector(`.popup__text--address`);\n  const popupPrice = offerPreset.querySelector(`.popup__text--price`);\n  const popupType = offerPreset.querySelector(`.popup__type`);\n  const popupCapacity = offerPreset.querySelector(`.popup__text--capacity`);\n  const popupTime = offerPreset.querySelector(`.popup__text--time`);\n  const popupFeatures = offerPreset.querySelector(`.popup__features`);\n  const popupDescription = offerPreset.querySelector(`.popup__description`);\n  const popupPhotos = offerPreset.querySelector(`.popup__photos`);\n\n  if (id) {\n    offerPreset.dataset.id = id;\n  }\n\n  popupAvatar.src = avatar ? avatar : popupAvatar.remove();\n  popupTitle.textContent = title;\n  popupAddress.textContent = address;\n  popupPrice.innerHTML = price ? `${price}&#x20bd;<span>/ночь</span>` : ``;\n  popupType.textContent = window.util.getHousingType(type);\n\n  popupCapacity.textContent = rooms && guests\n    ? `${window.util.getQEndings(rooms, `room`)} для ${window.util.getQEndings(guests, `guest`)}`\n    : ``;\n\n  popupTime.textContent = checkin && checkout\n    ? `Заезд после ${checkin}, выезд до ${checkout}`\n    : ``;\n\n  addOfferFeatures(popupFeatures, features);\n  popupDescription.textContent = description;\n  addOfferPhotos(popupPhotos, photos);\n\n  removeEmptyNodes(offerPreset);\n\n  return offerPreset;\n};\n\nconst openPopup = (id) => {\n  const card = window.card.offersWithId.find((item) => item.id === id);\n\n  openedCard = renderOfferCard(card);\n  map.append(openedCard);\n\n  popupClose = openedCard.querySelector(`.popup__close`);\n  popupClose.addEventListener(`click`, onPopupClose);\n  popupClose.addEventListener(`keydown`, onPopupEnterPress);\n  document.addEventListener(`keydown`, onPopupEscPress);\n};\n\nconst closePopup = () => {\n  if (openedCard) {\n    map.removeChild(openedCard);\n    openedCard = null;\n  }\n};\n\nconst onPopupClose = () => {\n  map.querySelector(`.map__pin--active`).classList.remove(`map__pin--active`);\n  closePopup();\n};\n\nconst onPopupEscPress = (evt) => {\n  if (evt.key === window.util.Key.ESCAPE) {\n    evt.preventDefault();\n    map.querySelector(`.map__pin--active`).classList.remove(`map__pin--active`);\n    closePopup();\n  }\n};\n\nconst onPopupEnterPress = (evt) => {\n  if (evt.key === window.util.Key.ENTER) {\n    evt.preventDefault();\n    closePopup();\n  }\n};\n\nconst openOffer = (evt) => {\n  if (evt.target.closest(`.map__pin`)) {\n    const targetPin = evt.target.closest(`.map__pin`);\n    const activePin = map.querySelector(`.map__pin--active`);\n    const id = targetPin.dataset.id;\n\n    if ((!activePin || activePin.dataset.id !== id) && id) {\n      if (activePin) {\n        activePin.classList.remove(`map__pin--active`);\n      }\n\n      targetPin.classList.add(`map__pin--active`);\n      closePopup();\n      openPopup(id);\n    }\n  }\n};\n\nwindow.card = {\n  renderOfferCard,\n  closePopup,\n  openOffer,\n};\n","'use strict';\n\nconst PINS_QUANTITY = 5;\n\nconst FILTER_ALL = `any`;\n\nconst FILTER_PRICE_LOW = `low`;\nconst FILTER_PRICE_MIDDLE = `middle`;\nconst FILTER_PRICE_HIGH = `high`;\n\nconst FILTER_PRICE_LIMIT_BOTTOM = 10000;\nconst FILTER_PRICE_LIMIT_TOP = 50000;\n\nconst filterForm = document.querySelector(`.map__filters`);\nconst housingType = filterForm.querySelector(`#housing-type`);\nconst housingPrice = filterForm.querySelector(`#housing-price`);\nconst housingRooms = filterForm.querySelector(`#housing-rooms`);\nconst housingGuests = filterForm.querySelector(`#housing-guests`);\nconst housingFeatures = filterForm.querySelectorAll(`.map__checkbox`);\n\nconst checkHousingType = (item) => {\n  if (housingType.value !== FILTER_ALL) {\n    return item.offer.type === housingType.value;\n  }\n\n  return true;\n};\n\nconst checkHousingPrice = (item) => {\n  switch (housingPrice.value) {\n    case FILTER_PRICE_MIDDLE:\n      return item.offer.price >= FILTER_PRICE_LIMIT_BOTTOM &&\n        item.offer.price <= FILTER_PRICE_LIMIT_TOP;\n    case FILTER_PRICE_LOW:\n      return item.offer.price < FILTER_PRICE_LIMIT_BOTTOM;\n    case FILTER_PRICE_HIGH:\n      return item.offer.price > FILTER_PRICE_LIMIT_TOP;\n    default:\n      return housingPrice.value === FILTER_ALL;\n  }\n};\n\nconst checkHousingRooms = (item) => {\n  if (housingRooms.value !== FILTER_ALL) {\n    return item.offer.rooms === +housingRooms.value;\n  }\n\n  return true;\n};\n\nconst checkHousingGuests = (item) => {\n  if (housingGuests.value !== FILTER_ALL) {\n    return item.offer.guests === +housingGuests.value;\n  }\n\n  return true;\n};\n\nconst checkHousingFeatures = (item) => {\n  for (const feature of housingFeatures) {\n    if (feature.checked && !item.offer.features.includes(feature.value)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nconst filterOffers = (data) => {\n  const filteredOffers = [];\n\n  for (let i = 0; i < data.length &&\n    filteredOffers.length < PINS_QUANTITY; i++) {\n    if (checkHousingType(data[i]) &&\n      checkHousingPrice(data[i]) &&\n      checkHousingRooms(data[i]) &&\n      checkHousingGuests(data[i]) &&\n      checkHousingFeatures(data[i])) {\n      filteredOffers.push(data[i]);\n    }\n  }\n\n  return filteredOffers;\n};\n\nconst onFilterFormChange = () => {\n  window.pin.updateOfferPins(filterOffers(window.card.offersWithId));\n};\n\nfilterForm.addEventListener(`change`, window.util.debounce(onFilterFormChange));\n\nwindow.filter = {\n  filterOffers,\n};\n","'use strict';\n\nconst map = document.querySelector(`.map`);\nconst offersZone = map.querySelector(`.map__pins`);\nconst mapFilters = document.querySelector(`.map__filters`);\nconst adForm = document.querySelector(`.ad-form`);\n\nconst onLoadSuccess = (data) => {\n  window.card.offersWithId = window.util.addId(data);\n  window.pin.updateOfferPins(window.filter.filterOffers(window.card.offersWithId));\n};\n\nconst onLoadError = (message) => {\n  const node = document.createElement(`div`);\n\n  node.classList.add(`on-error-message`);\n\n  node.textContent = message;\n  document.body.insertAdjacentElement(`afterbegin`, node);\n};\n\nconst activatePage = () => {\n  window.form.enableForm();\n  map.classList.remove(`map--faded`);\n  window.backend.load(onLoadSuccess, onLoadError);\n};\n\nconst deactivatePage = () => {\n  window.form.disableForm();\n  window.pin.deleteOfferPins();\n  map.classList.add(`map--faded`);\n  adForm.reset();\n  mapFilters.reset();\n  window.card.closePopup();\n  window.pin.mainMapPinReset();\n  window.form.completeAddressInput();\n};\n\ndeactivatePage();\n\noffersZone.addEventListener(`click`, (evt) => {\n  window.card.openOffer(evt);\n});\n\noffersZone.addEventListener(`keydown`, (evt) => {\n  if (evt.key === window.util.Key.ENTER) {\n    window.card.openOffer(evt);\n  }\n});\n\nwindow.main = {\n  activatePage,\n  deactivatePage,\n};\n"],"sourceRoot":""}